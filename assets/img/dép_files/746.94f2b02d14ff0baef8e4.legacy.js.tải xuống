(self.wpJsonpPcmallRcmd=self.wpJsonpPcmallRcmd||[]).push([[746],{20746:function(e,t,r){"use strict";r.d(t,{p:function(){return M}});var a=r(63804),n=r(1962),o=r.n(n),i=r(94187),s=a.createContext({enable:!1}),c=r(86704),l=function e(t){t.endsWith("/")&&(t=t.slice(0,t.length-1));var r=t.split("/"),a=r[r.length-1];return a.startsWith("https")&&a.includes("cf.shopee.")?e(decodeURIComponent(a)):(a.includes(".")&&(a=a.split(".")[0]),a.includes("_")&&(a=a.split("_")[0]),a)},u={},m={SG:"https://cf.shopee.sg",PH:"https://cf.shopee.ph"},d=(m[c.Env.getLocale()]||m.SG)+"/image/i/p/",h=function(e,t){var r=e+":"+t;if(!u[r]){var a=l(e);u[r]="number"==typeof t?d+"w"+t+"-webp/file/"+a:d+"webp/file/"+a}return u[r]};function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var f=function(e){var t=this;this.count=0,this.targetCount=0,this.whenExceedTargetCountPromiseResolves=[],this.increase=function(e){if(t.count+=e||1,t.count>=t.targetCount){for(var r,a=p(t.whenExceedTargetCountPromiseResolves);!(r=a()).done;)(0,r.value)(t.count);t.whenExceedTargetCountPromiseResolves=[]}},this.changeTargetCount=function(e){if(t.targetCount=e,t.count>=t.targetCount)for(var r,a=p(t.whenExceedTargetCountPromiseResolves);!(r=a()).done;)(0,r.value)(t.count)},this.whenExceedTargetCount=function(){return new Promise((function(e){t.count>=t.targetCount?e(t.count):t.whenExceedTargetCountPromiseResolves.push(e)}))},this.targetCount=e},v=new f(f.DEFAULT_TARGET=100),y=function(){var e=0,t=0;return{getResult:function(){var r;if("number"==typeof e&&0!==e)return{successRate:(r=t/e,Math.round(100*r)/100),errorCount:e-t}},addSuccessCount:function(){t+=1,e+=1},addErrorCount:function(){return e+=1},clear:function(){e=0,t=0}}},b=y(),I=y(),S="WyGqz7",C=["src","onImageReady","onImageError","hide","className","imageServerWidthOperator"];function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},E.apply(this,arguments)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var R=a.forwardRef((function(e,t){var r=e.src,n=e.onImageReady,i=e.onImageError,c=e.hide,l=e.className,u=e.imageServerWidthOperator,m=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,C),d=r&&r.startsWith("https://cf.shopee"),p=a.useContext(s).enable,g=a.useState(!1),f=g[0],y=g[1],R=a.useState(d&&p),_=R[0],O=R[1],j=a.useRef(null),A=a.useCallback((function(e){_?(b.addErrorCount(),O(!1)):(null==i||i(e),I.addErrorCount())}),[i,_,r]),N=a.useMemo((function(){return function(e){if(!Array.isArray(e))return e;var t=e.filter(Boolean);return function(e){for(var r,a=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);!(r=a()).done;){var n=r.value;"function"==typeof n?n(e):n&&(n.current=e)}}}([j,t])}),[t]);return a.useEffect((function(){j.current}),[r,f,_,A,n]),r?a.createElement("picture",{className:o()("+SFil7",c&&S)},_&&a.createElement("source",{type:"image/webp",srcSet:h(r,u)}),a.createElement("img",E({ref:function(e){N(e),y(!0)},src:r,onLoad:function(){var e=j.current;e&&(_?b.addSuccessCount():I.addSuccessCount(),v.increase(),null==n||n(e.currentSrc||e.src))},className:o()(l,c&&S)},{onError:A},m))):null})),_=a.memo(R),O=r(67274),j="BackgroundImagePortalAnchor",A=["hide","style","className","onImageReady","Component","src","onImageError","children","imageServerWidthOperator"];function N(){return N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},N.apply(this,arguments)}var P=a.forwardRef((function(e,t){var r=e.hide,n=e.style,i=e.className,s=e.onImageReady,c=e.Component,l=void 0===c?"div":c,u=e.src,m=e.onImageError,d=e.children,h=void 0===d?null:d,p=e.imageServerWidthOperator,g=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,A),f=a.useRef(u),v=a.useState(""),y=v[0],b=v[1],I=a.useState(!1),C=I[0],E=I[1],w=a.useCallback((function(e){null==s||s(e),b(e),E(!0)}),[s,b]);a.useEffect((function(){f.current!==u&&C&&E(!1)}),[u,C,E,f]),f.current=u;var R=a.useMemo((function(){var e;if(C)return null;var t=null===(e=document)||void 0===e?void 0:e.querySelector("#"+j),r=a.createElement(_,{hide:!0,onImageReady:w,src:u,onImageError:m,imageServerWidthOperator:p});return t?O.createPortal(r,t):r}),[C,j,w,u,m,p]);return a.createElement(l,N({style:N({},n,{backgroundImage:'url("'+y+'")'}),className:o()(i,r&&S),ref:t,"data-current-src":y},g),h,R)})),T=P;function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function z(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(void 0,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key))?n:String(n)),a)}var n}var x={container:"KbeBa1",heightKeeper:"whbKAf",placeholderContainer:"Rii9PA",imageLoading:"KBgGa1",imageReady:"a6jjFR",placeholder:"_0RCgFu"};function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},W.apply(this,arguments)}function F(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,L(e,t)}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}var B=new(function(){function e(e){if(void 0===e&&(e={}),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}var t,r,a=e.prototype;return a._set=function(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)},a.get=function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}},a.set=function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this},a.has=function(e){return this.cache.has(e)||this.oldCache.has(e)},a.peek=function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0},a.delete=function(e){var t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t},a.clear=function(){this.cache.clear(),this.oldCache.clear(),this._size=0},t=e,(r=[{key:"size",get:function(){for(var e,t=0,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.oldCache.keys());!(e=r()).done;){var a=e.value;this.cache.has(a)||t++}return this._size+t}}])&&z(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}())({maxSize:1e3}),M=function(e){function t(){return e.apply(this,arguments)||this}return F(t,e),t.prototype.render=function(){var e=this.props,t=e.useImgTag,r=e.src,n=e.className,i=e.wrapperClassName,c=e.placeholderClassName,l=e.placeholderWrapperClassName,u=e.customPlaceholder,m=e.hidePlaceholder,d=e.style,h=void 0===d?{}:d,p=e.children,g=e.imageServerWidthOperator,f=e.imageServerIsSrcGif,v=o()(n,x.heightKeeper);return r?a.createElement(s.Consumer,null,(function(t){var n=t.enable;return a.createElement(V,W({},e,{src:r,enableImageServer:n&&!f,imageServerWidthOperator:g}))})):a.createElement("div",{className:o()(x.container,i),style:h},t?a.createElement("img",{className:v}):a.createElement("div",{className:v}),a.createElement(U,{className:c,wrapperClassName:l,customPlaceholder:u,hidePlaceholder:!!m}),p)},t}(a.Component);function U(e){var t=e.className,r=e.wrapperClassName,n=e.customPlaceholder,i=e.hidePlaceholder;return a.createElement("div",{className:o()(r,x.placeholderContainer)},!i&&(n||a.createElement("div",{className:o()(x.placeholder,t)})))}M.disableLazyAnimation=!1;var V=function(e){function t(t){var r;return(r=e.call(this,t)||this)._mounted=!1,r._timeoutId=null,r.handleCallback=null,r.tryInsertImage=function(){r._wrapper&&r.state.imageReady&&r.props.useImgTag&&r.state.imageElement&&r._wrapper.insertBefore(r.state.imageElement,r._wrapper.firstChild)},r.tryRemoveImage=function(){r._wrapper&&r.state.imageReady&&r.props.useImgTag&&r.state.imageElement&&r._wrapper.removeChild(r.state.imageElement)},r.tryReplaceImage=function(){if(r.state.imageReady&&r.props.useImgTag){var e=r.handleCreateImageElement();e.src=r.props.src,e.onload=function(){r.handleImageOnLoad(e),r._wrapper&&r.state.imageElement&&(r._wrapper.replaceChild(e,r.state.imageElement),r.setState({imageElement:e}))}}},r.handleCreateImageElement=function(){var e=r.props,t=e.alt,a=e.src,n=e.isCovered,i=e.className,s=o()(i,x.imageReady),c=B.get(a),l=c?c.cloneNode():new Image(0,0);return t&&l.setAttribute("alt",t),l.setAttribute("class",s),l.setAttribute("style","object-fit: "+(n?"cover":"contain")),r.props.dataCy&&l.setAttribute("data-cy",r.props.dataCy),l.setAttribute("width","invalid-value"),l.setAttribute("height","invalid-value"),l},r.handleEnterViewport=function(){if(r.props.enableImageServer)return r.ImageServer_handleEnterViewport();var e=r.handleCreateImageElement();r.handleCallback=requestAnimationFrame((function(){r.props.useImgTag&&"decode"in e?(e.src=r.props.src,e.decode().then((function(){return r.handleImageOnLoad(e)})).catch(r.handleImageError)):(e.onload=function(){return r.handleImageOnLoad(e)},e.onerror=r.handleImageError,e.src=r.props.src)})),r._timeoutId=setTimeout((function(){return r.handleImageOnLoad(e)}),5e3)},r.handleImageOnLoad=function(e){r._timeoutId&&clearTimeout(r._timeoutId),B.set(r.props.src,e),r._mounted&&!r.state.imageReady&&(r.setState({imageReady:!0,imageElement:r.props.useImgTag?e:null}),"function"==typeof r.props.onImageReady&&r.props.onImageReady())},r.handleImageError=function(e){r._timeoutId&&clearTimeout(r._timeoutId),r.props.onError&&r.props.onError(e)},r.onRef=function(e){r._wrapper=e},r.ImageServer_handleImageReady=function(){r.setState({imageReady:!0}),"function"==typeof r.props.onImageReady&&r.props.onImageReady()},t.enableImageServer?(r.ImageServer_constructor(),function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)):(B.get(r.props.src)?r.state={imageReady:!0,imageElement:r.props.useImgTag?r.handleCreateImageElement():null}:r.state={imageReady:r.props.disabled||M.disableLazyAnimation,imageElement:null},r)}F(t,e);var r=t.prototype;return r.componentDidMount=function(){this._mounted=!0,(0,i.Bt)(this._wrapper,{enterViewCallback:this.handleEnterViewport}),this.tryInsertImage()},r.componentDidUpdate=function(e,t){this.props.enableImageServer||this.props.useImgTag&&(!t.imageReady&&this.state.imageReady?this.tryInsertImage():t.imageReady&&!this.state.imageReady?this.tryRemoveImage():e.src!==this.props.src&&this.tryReplaceImage())},r.componentWillUnmount=function(){this._mounted=!1;var e=this._wrapper;e&&(0,i.p_)(e),this.handleCallback&&cancelAnimationFrame(this.handleCallback),this._timeoutId&&clearTimeout(this._timeoutId)},r.renderImage=function(){var e=this.props,t=e.src,r=e.className,n=e.isCovered,i=e.useImgTag,s=e.alt,c=o()(r,x.imageReady);if(M.disableLazyAnimation)return a.createElement("img",{alt:s,src:t,className:c,style:{objectFit:n?"cover":"contain",width:"100%",paddingTop:0}});var l=this.state.imageReady,u=i&&!this.state.imageElement&&!this.props.enableImageServer;if(!l||u){var m=o()(r,x.imageLoading);return i?a.createElement("img",{className:m}):a.createElement("div",{className:m})}return this.props.enableImageServer||i?null:a.createElement("div",{className:c,style:{backgroundImage:"url("+t+")",backgroundSize:n?"cover":"contain",backgroundRepeat:"no-repeat"}})},r.ImageServer_constructor=function(){this.state={imageReady:!1,imageElement:null,ImageServer_hasEnterViewport:!1}},r.ImageServer_componentDidUpdate=function(){},r.ImageServer_handleEnterViewport=function(){this.setState({ImageServer_hasEnterViewport:!0})},r.ImageServer_renderImage=function(){var e=this.props,r=e.src,n=e.useImgTag,i=e.isCovered,s=e.className,c=e.alt,l=e.imageServerWidthOperator,u=e.onError,m=this.state,d=m.ImageServer_hasEnterViewport,h=m.imageReady;if(!d)return null;var p=o()(s,x.imageReady);return n?a.createElement(_,{src:r,onImageReady:this.ImageServer_handleImageReady,hide:!h,className:p,alt:c,style:i?t.ImageServer_ObjectFitCoverStyle:t.ImageServer_ObjectFitContainStyle,width:"invalid-value",height:"invalid-value",imageServerWidthOperator:l,onImageError:u}):a.createElement(T,{className:p,style:i?t.ImageServer_BackgroundCoverStyle:t.ImageServer_BackgroundContainStyle,hide:!h,src:r,onImageReady:this.ImageServer_handleImageReady,imageServerWidthOperator:l,onImageError:u})},r.render=function(){var e=this.props,t=e.wrapperClassName,r=e.placeholderClassName,n=e.placeholderWrapperClassName,i=e.customPlaceholder,s=e.hidePlaceholder,c=e.style,l=void 0===c?{}:c,u=e.children,m=e.enableImageServer;return a.createElement("div",{ref:this.onRef,className:o()(x.container,t),style:l},m&&this.ImageServer_renderImage(),this.renderImage(),!this.state.imageReady&&a.createElement(U,{className:r,wrapperClassName:n,customPlaceholder:i,hidePlaceholder:s}),u)},t}(a.Component);V.defaultProps={disabled:!1},V.ImageServer_ObjectFitCoverStyle={objectFit:"cover"},V.ImageServer_ObjectFitContainStyle={objectFit:"contain"},V.ImageServer_BackgroundCoverStyle={backgroundSize:"cover",backgroundRepeat:"no-repeat"},V.ImageServer_BackgroundContainStyle={backgroundSize:"contain",backgroundRepeat:"no-repeat"}}}]);
//# sourceMappingURL=https://sourcemap.webfe.shopee.io/pcmall-rcmd/_/746.94f2b02d14ff0baef8e4.legacy.js.map