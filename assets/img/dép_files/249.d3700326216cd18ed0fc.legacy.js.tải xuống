(self.wpJsonpPcmallFlashsale=self.wpJsonpPcmallFlashsale||[]).push([[249],{4239:function(t,e,n){"use strict";n.d(e,{IJ:function(){return o},Xu:function(){return s}});var r,i=n(8085),a=n(1183);!function(){switch((0,a.Kd)()){case"ID":case"TW":case"VN":case"TH":case"MY":case"SG":case"PH":;}}(),function(t){t.ADD="add",t.DELETE="delete"}(r||(r={}));var o=(0,i.n)("FETCH_BRAND_SALE_ALL_SESSIONS"),s=((0,i.n)("BATCH_FETCH_BRAND_SALE_ITEMS"),(0,i.n)("FETCH_BRAND_SALE_ITEMS"),(0,i.n)("FETCH_BRAND_SALE_SOLDOUT_ITEM"));(0,i.n)("FETCH_BRAND_SALE_ALL_ITEMS_IDS")},859:function(t,e,n){"use strict";n.d(e,{Sc:function(){return u},dz:function(){return c},Gz:function(){return _},oE:function(){return i},TC:function(){return a},_1:function(){return m},uO:function(){return p},Yv:function(){return d},iw:function(){return f},g8:function(){return E},JB:function(){return l},WK:function(){return S},gJ:function(){return A},O9:function(){return I}});var r,i,a,o=n(6785),s=n(7582),u=5,c=10,_=50;!function(t){t[t.FLASH_SALE=0]="FLASH_SALE",t[t.BRAND_SALE=1]="BRAND_SALE",t[t.SHOP_FLASH_SALE=2]="SHOP_FLASH_SALE",t[t.FLASH_SALE_CATEGORY=3]="FLASH_SALE_CATEGORY"}(i||(i={})),function(t){t.FLASH_SALE="flash_sale",t.BRAND_SALE="brand_sale",t.SHOP_FLASH_SALE="shop_flash_sale",t.MICROSITE_FLASH_SALE="microsite_flash_sale",t.MICROSITE_SHOP_FLASH_SALE="microsite_shop_flash_sale"}(a||(a={}));var d,f,E,l,S,m=new Set(["test","uat","live"]),p=[0,1,2,3,4];!function(t){t.FLASH_SALE_LANDING="flashSaleLanding",t.FLASH_SALE_ENTRANCE="flashSaleEntrance",t.BRAND_SALE_ENTRANCE="brandSaleEntrance",t.BRAND_SALE_LANDING="brandSaleLanding",t.SMART_FLASH_SALE_ENTRANCE="smartFlashSaleEntrance",t.SMART_FLASH_SALE_LANDING="smartFlashSaleLanding",t.SHOP_ENTRANCE="shopEntrance",t.SHOP_FLASH_SALE="shopFlashSale",t.SHOP_CAMPAIGN="shopCampaign",t.FLASH_SALE_MICROSITE="flashSaleMicrosite",t.SOLD_OUT_PAGE="soldOutPage"}(d||(d={})),function(t){t.PC="pc",t.RW="rw"}(f||(f={})),function(t){t.SALE_PRICE="sale_price",t.ORIGINAL_PRICE="original_price",t.HIDDEN_PRICE="hidden_price"}(E||(E={})),function(t){t.BUY_NOW="buy_now",t.VIEW_DETAILS="view_details"}(l||(l={})),function(t){t.RW_VERTICAL_ITEM_CARD="rw_vertical_item_card",t.RW_HORIZONTAL_ITEM_CARD="rw_horizontal_item_card",t.PC_LANDING_PAGE_ITEM_CARD="pc_landing_page_item_card",t.PC_ENTRANCE_PAGE_ITEM_CARD="pc_entrance_page_item_card"}(S||(S={}));var A=new Set(["PL","ES"]),I=new Set(["MX"]);(r={})[d.FLASH_SALE_LANDING]=o.LX,r[d.SMART_FLASH_SALE_LANDING]=s.iO},644:function(t,e,n){"use strict";n.d(e,{IG:function(){return i},Gl:function(){return o},$X:function(){return s},bG:function(){return u}});var r,i,a=n(8085);!function(t){t[t.FLASH_SALE=0]="FLASH_SALE",t[t.BRAND_SALE=1]="BRAND_SALE",t[t.SHOP_FLASH_SALE=2]="SHOP_FLASH_SALE",t[t.FLASH_SALE_CATEGORY=3]="FLASH_SALE_CATEGORY"}(i||(i={}));var o={system_generated:1,flash_sale_category:2,customised:3},s={SYSTEM_GENERATED:"system_generated",FLASH_SALE_CATEGORY:"flash_sale_category",CUSTOMISED:"customised"},u=((r={default:0}).deboost_for_customized_item_order=1,r.hide_from_ongoing_session=2,(0,a.n)("FETCH_MICROSITE_SOLDOUT_ITEM"))},6785:function(t,e,n){"use strict";n.d(e,{g$:function(){return u},s5:function(){return c},pw:function(){return _},LX:function(){return d},tl:function(){return f},Tx:function(){return r},aH:function(){return i},_M:function(){return a},Af:function(){return o},mL:function(){return E},Ft:function(){return l},gm:function(){return S},Vs:function(){return m},c5:function(){return p},u:function(){return A},H6:function(){return I},gM:function(){return L},Oy:function(){return T},Ex:function(){return O},hh:function(){return h},gH:function(){return v}});var r,i,a,o,s=n(8085),u=0,c=0,_=16,d=25,f=999;!function(t){t[t.SHOPEE_ITEM=0]="SHOPEE_ITEM",t[t.DIGITAL_PURCHASE=1]="DIGITAL_PURCHASE"}(r||(r={})),function(t){t[t.COMING_SOON=0]="COMING_SOON",t[t.ON_GOING=1]="ON_GOING",t[t.ENDED=2]="ENDED"}(i||(i={})),function(t){t[t.UNDEFINED=0]="UNDEFINED",t[t.START=1]="START",t[t.END=2]="END"}(a||(a={})),function(t){t.SESSION_ENDS="session_ends",t.TIME_OFF_SYNC="time_off_sync",t.NO_SELLING_OUT="no_selling_out"}(o||(o={}));var E=(0,s.n)("FETCH_FLASH_SALE_ALL_SESSIONS"),l=(0,s.n)("FETCH_FLASH_SALE_ITEM_IDS"),S=(0,s.n)("BATCH_FETCH_FLASH_SALE_ITEMS"),m=(0,s.n)("FETCH_FLASH_SALE_ITEMS"),p=(0,s.n)("FETCH_FLASH_SALE_SOLDOUT_ITEM"),A="UPDATE_SELECTED_CFS_PROMOTION_AND_CATEGORY_ID",I=" UPDATE_SELECTED_CATEGORY_ID",L="UPDATE_SELECTED_CFS_PROMOTION_ID",T="SET_SHOULD_MOVE_BARS_UP",O="REORDER_ITEMS",h="UPDATE_FLASH_SALE_ITEM_IDS",v="RESET_INITIAL_FETCH_STATUS"},6560:function(t,e,n){"use strict";var r;n.d(e,{a:function(){return r},g:function(){return i}}),function(t){t[t.INIT=0]="INIT",t[t.REQ=1]="REQ",t[t.OK=2]="OK",t[t.ERR=3]="ERR"}(r||(r={}));var i=0},7582:function(t,e,n){"use strict";n.d(e,{Mm:function(){return i},NY:function(){return a},iO:function(){return o},HK:function(){return s},hz:function(){return u},EX:function(){return c},y_:function(){return _},N9:function(){return d},rW:function(){return f},Js:function(){return E},S4:function(){return l},q2:function(){return S},jP:function(){return m}});var r=n(8085),i=0,a=20,o=25,s=6,u=6,c=6,_=6,d=(0,r.n)("FETCH_SMART_FLASH_SALE_ALL_SESSIONS"),f=(0,r.n)("FETCH_SMART_FLASH_SALE_ALL_ITEM_IDS"),E=(0,r.n)("BATCH_FETCH_SMART_FLASH_SALE_ITEMS"),l="UPDATE_SELECTED_SMART_PROMOTION_ID",S="REORDER_SMRAT_FLASH_SALE_ITEMS",m="UPDATE_SMART_FLASH_SALE_ITEM_IDS"},5562:function(t,e,n){"use strict";n.d(e,{Ug:function(){return r},tk:function(){return i},KE:function(){return a},vm:function(){return o},g1:function(){return s},KF:function(){return u}});var r="BATCH_FETCH_FLASH_SALE_BY_PROMOTIONIDS_REQUESTED",i="BATCH_FETCH_FLASH_SALE_BY_PROMOTIONIDS_SUCCESS",a="BATCH_FETCH_FLASH_SALE_BY_PROMOTIONIDS_FAILED",o="switch_tab",s="/api/v2/flash_sale/get_shop_flash_sales_by_promotionids",u="/api/v4/flash_sale/get_selected_flash_sales_by_promotionids"},7122:function(t,e,n){"use strict";n.d(e,{UO:function(){return S},RF:function(){return m},nu:function(){return p},TN:function(){return A},NR:function(){return I},Zk:function(){return O},ds:function(){return h}});var r=n(3255),i=n(6846),a=n(6704),o=n(1183),s=n(859),u=n(8746),c=n(5136),_=n(7944),d=n(9622),f=(0,o.Kd)(),E=a.I18n.t,l=(0,r.getUtilsByCountry)(f,(0,o.of)()).compactServerCurrency,S=function(t){return(0,i.AW)(t.search)};function m(t){if(t){if(t.discount_value)return E("label_voucher_product_value_discount",{value:l(t.discount_value)});if(t.discount_percentage)return E("label_voucher_product_percentage_discount",{value:(e=t.discount_percentage,"zh-Hant"===(0,o.of)()?Math.round(100-e)/10:Math.round(e))});if(t.coin_percentage)return E("label_voucher_product_coins_cashback",{value:t.coin_percentage})}var e;return null}function p(t,e,n,r){switch(void 0===r&&(r=!1),e){case s.Yv.FLASH_SALE_ENTRANCE:var i=n.promotionId,a=n.itemId,o=n.categoryId,_=n.shopId;return r?(0,u.gW)(t).getUrl({promotionId:i,fromItem:a,fromShop:_}):(0,u.Zz)(t).getUrl({promotionId:i,fromItem:a,categoryId:o});case s.Yv.BRAND_SALE_ENTRANCE:var d=n.promotionId,f=n.itemId,E=n.shopId;return(0,u.gW)(t).getUrl({promotionId:d,fromItem:f,fromShop:E});case s.Yv.SMART_FLASH_SALE_ENTRANCE:var l=n.promotionId,S=n.itemId;return(0,u.tN)(t).getUrl({promotionId:l,fromItem:S});case s.Yv.SHOP_ENTRANCE:case s.Yv.SHOP_FLASH_SALE:case s.Yv.SHOP_CAMPAIGN:case s.Yv.FLASH_SALE_LANDING:case s.Yv.BRAND_SALE_LANDING:case s.Yv.SMART_FLASH_SALE_LANDING:case s.Yv.SOLD_OUT_PAGE:var m=n.shopId,p=n.itemId,A=n.name;return m&&p?A?c.Z.getUrl({seoName:A,shopId:m,itemId:p}):c.O.getUrl({shopId:m,itemId:p}):"";default:return""}}function A(t,e){if(void 0===e&&(e=!1),e)switch(t){case s.oE.FLASH_SALE:case s.oE.BRAND_SALE:case s.oE.FLASH_SALE_CATEGORY:return s.TC.MICROSITE_FLASH_SALE;case s.oE.SHOP_FLASH_SALE:return s.TC.MICROSITE_SHOP_FLASH_SALE;default:return s.TC.MICROSITE_FLASH_SALE}else switch(t){case s.oE.FLASH_SALE:return s.TC.FLASH_SALE;case s.oE.BRAND_SALE:return s.TC.BRAND_SALE;case s.oE.SHOP_FLASH_SALE:return s.TC.SHOP_FLASH_SALE}}function I(t,e){var n,r;return(null==t||null===(n=t.item)||void 0===n?void 0:n.itemid)===(null==e||null===(r=e.item)||void 0===r?void 0:r.itemid)&&(null==t?void 0:t.isNewFlagEnabled)===(null==e?void 0:e.isNewFlagEnabled)}var L=(0,d.S)((0,o.of)()),T=_.formatDuration.bind(null,_.durationLocales[L]),O=function(t,e){if(t){var n="TW"===__LOCALE__?(100-t.extra_discount)/10:t.extra_discount,r="";if(t.end_time&&t.start_time&&(i=t.start_time,a=t.end_time,o=new Date(1e3*a),s=new Date(1e3*i),u=(0,_.timeBetween)("minute",o,s),r=T(o,s,{totalUnits:1,endUnit:"minute",roundLast:u>60?"floor":u<1?"ceil":"round",unitLowerBounds:{year:Number.MAX_VALUE,month:Number.MAX_VALUE,week:Number.MAX_VALUE,day:Number.MAX_VALUE}})),t&&"function"==typeof e)return r?e("fs_extra_n_off_applied_for_first_m_in_x",{n:n,m:t.extra_discount_stock,x:r}):e("fs_extra_n_off_applied_for_first_m",{n:n,m:t.extra_discount_stock})}var i,a,o,s,u;return""},h=function(t){return function(t){return t.map((function(t){var e=t.start_time,n=Date.now()/1e3;return t.is_ongoing=e<=n,t}))}(function(t){return t.filter((function(t){return t.end_time>Date.now()/1e3}))}(t))}},8840:function(t,e,n){"use strict";n.d(e,{MK:function(){return L},_h:function(){return I},qN:function(){return m},Qg:function(){return p},C1:function(){return A},R_:function(){return T}});var r=n(1408),i={MFS_RCMD:{TEST:"prm.UD",UAT:"prm.JZ",LIVE:"prm.QK"},ITEM_CARD_REVAMP:{TEST:"prm.KO",UAT:"prm.NO",LIVE:"prm.RQ"},FLEX_BOOSTING:{TEST:"prm.OP",UAT:"prm.PS",LIVE:"prm.SC"},CAT_RCMD:{TEST:"prm.KK",UAT:"prm.PF",LIVE:"prm.MV"}},a={TEST:{CONTROL:1,TREAMENT_ONE:2,TREAMENT_TWO:4,TREAMENT_THREE:3},UAT:{CONTROL:1,TREAMENT_ONE:2,TREAMENT_TWO:4,TREAMENT_THREE:3},LIVE:{CONTROL:1,TREAMENT_ONE:2,TREAMENT_TWO:4,TREAMENT_THREE:3}},o={TEST:{MANUAL_RCMD:1,MANUAL_FLEX_RCMD:6,MANUAL_MOVE_FLEX:2,ONLY_RCMD:3,TOP_FIX_MOVE_FLEX:4,TOP_FIX_ONLY_RCMD:5},UAT:{MANUAL_RCMD:1,MANUAL_FLEX_RCMD:6,MANUAL_MOVE_FLEX:2,ONLY_RCMD:3,TOP_FIX_MOVE_FLEX:4,TOP_FIX_ONLY_RCMD:5},LIVE:{MANUAL_RCMD:1,MANUAL_FLEX_RCMD:6,MANUAL_MOVE_FLEX:2,ONLY_RCMD:3,TOP_FIX_MOVE_FLEX:4,TOP_FIX_ONLY_RCMD:5}},s={TEST:{OLD_MANUAL:1,MANUAL_RCMD:2},UAT:{OLD_MANUAL:1,MANUAL_RCMD:2},LIVE:{OLD_MANUAL:1,MANUAL_RCMD:2}},u={SCENE_KEY:"mktplace_fs",EXPERIMENT_NAME:{TEST:"FS_add_mall_and_preferred_tag",UAT:"FS_add_mall_and_preferred_tag",LIVE:"PC_FS_add_mall_and_preferred_tag_1234"},GROUP_NAME:{CONTROL:"control",TEST:"test"}},c=n(859),_=n(1183),d=n(1437),f=n(6384),E=n(7753);function l(){var t=(0,_.dU)().toUpperCase(),e=c._1.has(t.toLowerCase());return{ENV:t,isEnvSupported:e}}function S(){var t=l().ENV;return{isInTreamentOne:(0,r.getVariateConfig)(i.ITEM_CARD_REVAMP[t])===a[t].TREAMENT_ONE,isInTreamentTwo:(0,r.getVariateConfig)(i.ITEM_CARD_REVAMP[t])===a[t].TREAMENT_TWO,isInTreamentThree:(0,r.getVariateConfig)(i.ITEM_CARD_REVAMP[t])===a[t].TREAMENT_THREE}}function m(){var t=l().isEnvSupported?S():{},e=t.isInTreamentOne,n=void 0!==e&&e,r=t.isInTreamentTwo,i=void 0!==r&&r,a=t.isInTreamentThree;return n||i||void 0!==a&&a}function p(){var t=l().isEnvSupported?S():{},e=t.isInTreamentOne,n=void 0!==e&&e,r=t.isInTreamentTwo;return n||void 0!==r&&r}function A(){var t=l().isEnvSupported?S():{},e=t.isInTreamentTwo,n=void 0!==e&&e,r=t.isInTreamentThree;return n||void 0!==r&&r}var I=function(){var t=l(),e=t.ENV;if(!t.isEnvSupported||!(0,d.isFeatureEnabled)(f.MS0))return 1;switch((0,r.getVariateConfig)(i.FLEX_BOOSTING[e])){case o[e].MANUAL_RCMD:return 1;case o[e].MANUAL_FLEX_RCMD:return 2;case o[e].MANUAL_MOVE_FLEX:return 3;case o[e].ONLY_RCMD:return 4;case o[e].TOP_FIX_MOVE_FLEX:return 5;case o[e].TOP_FIX_ONLY_RCMD:return 6;default:return 1}},L=function(){var t=l(),e=t.ENV;return t.isEnvSupported?(0,r.getVariateConfig)(i.CAT_RCMD[e])===s[e].OLD_MANUAL?0:(0,r.getVariateConfig)(i.CAT_RCMD[e])===s[e].MANUAL_RCMD?1:0:0},T=function(){var t=l().ENV,e=(0,E.J)(u.SCENE_KEY,u.EXPERIMENT_NAME[t])[0];return(null==e?void 0:e.group_name)===u.GROUP_NAME.TEST}},1586:function(t,e,n){"use strict";n.d(e,{Z:function(){return st}});var r=n(3804),i=n.n(r),a=n(6704),o=n(7340),s=n(5325),u=n(612),c=n(302),_=n(1111),d=n(3490),f=n(7762),E=n(7987),l=n(6134),S=n(4857),m=n(1993),p=n(6560),A=n(6785),I=n(1437),L=n(6384);function T(){return T=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},T.apply(this,arguments)}n(4945),n(7857);var O=function(t,e){var n=t.find((function(t){return t===e}));return e&&n&&(t=t.filter((function(t){return t!==e}))).unshift(n),t};function h(){return h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h.apply(this,arguments)}function v(){return v=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},v.apply(this,arguments)}function g(t,e){switch(e.type){case A.gm.REQUESTED:var n,r=e.categoryid,i=e.isInitialFetch;return v({},t,((n={})[r]=i?{items:[],normalisedItems:{},fetchedItemNumber:0,initialFetchStatus:p.a.REQ}:t[r],n));case A.gm.SUCCESS:var a,o=e.items,s=e.categoryid,u=e.isInitialFetch,c=t[s],_=c.items,d=c.fetchedItemNumber,f=c.initialFetchStatus,E=_.concat(o),l=o.reduce((function(t,e){return t[e.itemid]=e,t}),v({},t[s].normalisedItems));return v({},t,((a={})[s]={items:E,normalisedItems:l,fetchedItemNumber:d+o.length,initialFetchStatus:u?p.a.OK:f},a));case A.gm.FAILED:var S,m=e.categoryid,I=e.isInitialFetch;return v({},t,((S={})[m]=I?{items:[],normalisedItems:{},fetchedItemNumber:0,initialFetchStatus:p.a.ERR}:t[m],S))}}function R(){return R=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},R.apply(this,arguments)}function N(){return N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},N.apply(this,arguments)}function C(){return C=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},C.apply(this,arguments)}function F(){return F=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},F.apply(this,arguments)}var y=n(4239);function D(){return D=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D.apply(this,arguments)}function M(){return M=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},M.apply(this,arguments)}function H(){return H=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},H.apply(this,arguments)}function b(t){for(var e={0:{itemIdsToFetch:[],boundaries:"",isRequested:!1}},n=0;n<t.length;n+=A.LX){var r=n+A.LX<=t.length?n+A.LX:t.length,i=t.slice(n,r);e[Math.floor(n/A.LX)]={itemIdsToFetch:i,boundaries:i[0]+"-"+i[i.length-1],isRequested:!1}}return e}var U={flashSaleAllSessions:function(t,e){switch(void 0===t&&(t={promotionIds:[],sessions:{}}),e.type){case A.mL.REQUESTED:case A.mL.FAILED:return t;case A.mL.SUCCESS:var n=e.payload,r=n.sessions,i=n.recommendation_trace_id;return{promotionIds:r.map((function(t){return t.promotionid})),sessions:r.reduce((function(t,e){return t[e.promotionid]=T({},e,{recommendation_trace_id:i}),t}),{})};case A.Ft.SUCCESS:var a=(0,I.isFeatureEnabled)(L.kOz),o={catid:A.tl,catname:"",image:""},s=e.payload,u=s.promotionid,c=s.data.selling_out_item_brief_list;if(a&&c.length>4){var _=t.sessions[u].categories;t.sessions[u].categories=[_[0],o].concat(_.slice(1))}return T({},t);case A.gH:return{promotionIds:[],sessions:{}};default:return t}},fetchFlashSaleAllSessionsStatus:function(t,e){switch(void 0===t&&(t=p.a.INIT),e.type){case A.mL.REQUESTED:return p.a.REQ;case A.mL.SUCCESS:return p.a.OK;case A.mL.FAILED:return p.a.ERR;case A.gH:return p.a.INIT;default:return t}},flashSaleItemIds:function(t,e){switch(void 0===t&&(t={}),e.type){case A.Ft.REQUESTED:var n;return h({},t,((n={})[e.payload.promotionid]={fetchItemIdsStatus:p.a.REQ},n));case A.Ft.FAILED:var r;return h({},t,((r={})[e.payload.promotionid]={fetchItemIdsStatus:p.a.ERR},r));case A.Ft.SUCCESS:var i,a=e.payload,o=a.data,s=o.item_brief_list,u=o.selling_out_item_brief_list,c=a.selectedItemId;return h({},t,((i={})[a.promotionid]=function(t){var e,n=t.item_brief_list,r=t.selectedItemId,i={itemids:t.selling_out_item_brief_list.map((function(t){return t.itemid}))},a=n.map((function(t){return t.itemid})),o={itemids:O(a,r)};return h({},n.reduce((function(t,e){var n=e.catid,r=e.itemid;return t[n]=t[n]||{itemids:[]},t[n].itemids.push(r),t}),{}),((e={})[A.g$]=o,e[A.tl]=i,e.fetchItemIdsStatus=p.a.OK,e))}({item_brief_list:s,selling_out_item_brief_list:u,selectedItemId:c}),i));case A.Ex:var _,d,f=e.payload,E=f.promotionid,l=f.itemId,S=t[E][A.g$].itemids,m=O(S,l);return h({},t,((d={})[E]=h({},t[E],((_={})[A.g$]=h({},t[E][A.g$],{itemids:m}),_)),d));case A.hh:var I,L,T=e.payload,v=T.boundariesOfItemIdsToFetch,g=T.fetchedItemIds,R=T.promotionid,N=T.categoryid,C=t[R][N].itemids,F=v.split("-").map((function(t){return parseInt(t,10)})),y=C.indexOf(F[0]),D=C.indexOf(F[1]),M=C.slice(0,y),H=C.slice(D+1),b=M.concat(g).concat(H);return h({},t,((L={})[R]=h({},t[R],((I={})[N]=h({},t[R][N],{itemids:b}),I)),L));case A.gH:return{};default:return t}},fetchFlashSaleItemIdsStatus:function(t,e){switch(void 0===t&&(t=p.a.INIT),e.type){case A.Ft.REQUESTED:return p.a.REQ;case A.Ft.SUCCESS:return p.a.OK;case A.Ft.FAILED:return p.a.ERR;case A.gH:return p.a.INIT;default:return t}},flashSaleItemsOnLanding:function(t,e){void 0===t&&(t={});var n=e.type;switch(n){case A.gm.REQUESTED:var r,i=e.payload,a=i.promotionid,o=i.categoryid,s=i.isInitialFetch;return v({},t,((r={})[a]=g(t[a],{type:n,categoryid:o,isInitialFetch:s}),r));case A.gm.SUCCESS:var u,c=e.payload,_=c.data.items,d=c.promotionid,f=c.categoryid,E=c.isInitialFetch;return v({},t,((u={})[d]=g(t[d],{type:n,categoryid:f,isInitialFetch:E,items:_}),u));case A.gm.FAILED:var l,S=e.payload,m=S.promotionid,p=S.categoryid,I=S.isInitialFetch;return v({},t,((l={})[m]=g(t[m],{type:n,categoryid:p,isInitialFetch:I}),l));case A.Ex:var L,T=e.payload,O=T.promotionid,h=T.itemId,R=t[O][A.g$].items;return v({},t,((L={})[O]=function(t,e){var n,r=function(t,e){var n=t.find((function(t){return t.itemid===e}));return e&&n&&(t=t.filter((function(t){return t.itemid!==e}))).unshift(n),t}(e.items,e.itemId);return v({},t,((n={})[A.g$]=v({},t[A.g$],{items:r}),n))}(t[O],{items:R,itemId:h}),L));case A.gH:return{};default:return t}},fetchFlashSaleItemsOnLandingStatus:function(t,e){switch(void 0===t&&(t=p.a.INIT),e.type){case A.gm.REQUESTED:return p.a.REQ;case A.gm.SUCCESS:return p.a.OK;case A.gm.FAILED:return p.a.ERR;case A.gH:return p.a.INIT;default:return t}},fetchFlashItemsOnEntranceStatus:function(t,e){switch(void 0===t&&(t=p.a.INIT),e.type){case A.Vs.REQUESTED:return p.a.REQ;case A.Vs.SUCCESS:return p.a.OK;case A.Vs.FAILED:return p.a.ERR;case A.gH:return p.a.INIT;default:return t}},flashSaleItemsOnEntrance:function(t,e){switch(void 0===t&&(t={items:[],session:{}}),e.type){case A.Vs.REQUESTED:return t;case A.Vs.SUCCESS:var n=e.payload,r=n.item_brief_list,i=n.items,a=n.session,o=n.recommendation_trace_id,s=n.mfs_tracker_info;return{items:i.map((function(t){return R({},t,r.find((function(e){return e.itemid===t.itemid})),{recommendation_trace_id:o,mfs_tracker_info:s})})),session:a};case A.Vs.FAILED:return t;case A.gH:return{items:[],session:{}};default:return t}},flashSaleAllItemsRecommendation:function(t,e){var n;switch(void 0===t&&(t={}),e.type){case A.Ft.REQUESTED:case A.Ft.FAILED:return t;case A.Ft.SUCCESS:var r=e.payload,i=r.data.item_brief_list,a=r.recommendation_trace_id;return N({},t,(n=a,i.reduce((function(t,e){var r=e.itemid,i=e.from,a=e.recommendation_info,o=e.is_flex_boosting,s="boolean"==typeof o?o:-1;return t[r]={from:i,recommendation_info:a,recommendation_trace_id:n,is_flex_boosting:s},t}),{})));case A.gH:return{};default:return t}},categoriesByPromotion:function(t,e){switch(void 0===t&&(t={}),e.type){case A.mL.REQUESTED:case A.mL.FAILED:return t;case A.mL.SUCCESS:var n=e.payload.sessions.reduce((function(t,e){var n=e.promotionid,r=e.categories,i=r.reduce((function(t,e){return t[e.catid]=e,t}),{}),a=r.map((function(t){return t.catid}));return t[n]={categoryIds:a,categories:i},t}),{});return n;case A.Ft.SUCCESS:var r,i,a=(0,I.isFeatureEnabled)(L.kOz),o={catid:A.tl,catname:"",image:""},s=e.payload,u=s.promotionid,c=s.data.selling_out_item_brief_list,_=t[u],d=_.categoryIds,f=_.categories;return a&&c.length>4&&(d=[d[0],A.tl].concat(d.slice(1)),f=C({},f,((i={})[A.tl]=o,i))),C({},t,((r={})[u]={categoryIds:d,categories:f},r));case A.gH:return{};default:return t}},selectedPromotionId:function(t,e){void 0===t&&(t=null);var n=e.type,r=(e.payload||{}).selectedPromotionId;switch(n){case A.gM:case A.u:return r;case A.gH:return null;default:return t}},selectedCategoryId:function(t,e){void 0===t&&(t=null);var n=e.type,r=(e.payload||{}).selectedCategoryId;switch(n){case A.H6:case A.u:return r;case A.gH:return null;default:return t}},shouldMoveBarsUp:function(t,e){return void 0===t&&(t=!1),e.type===A.Oy?e.payload.shouldMoveBarsUp:t},queryObjects:function(t,e){switch(void 0===t&&(t={}),e.type){case A.u:var n,r=e.payload,i=r.selectedPromotionId,a=r.selectedCategoryId,o=r.selectedItemId;return F({},t,((n={})[i+"-"+a]=o?{fromItem:o,promotionId:i,categoryId:a}:{promotionId:i,categoryId:a},n));case A.gH:return{};default:return t}},timeSlotToIdMap:function(t,e){switch(void 0===t&&(t={}),e.type){case A.mL.SUCCESS:return e.payload.sessions.reduce((function(t,e){var n=e.promotionid,r=e.start_time+"-"+e.end_time;return r in t?t[r].flashSaleId=n:t[r]={flashSaleId:n},t}),D({},t));case y.IJ.SUCCESS:return e.payload.sessions.filter((function(t){return t.brands.length>0})).reduce((function(t,e){var n=e.promotionid,r=e.start_time+"-"+e.end_time;return r in t?t[r].brandSaleId=n:t[r]={brandSaleId:n},t}),D({},t));case A.gH:return{};default:return t}},soldOutItem:function(t,e){switch(void 0===t&&(t={item:{},fetchStatus:p.a.INIT}),e.type){case A.c5.REQUESTED:return M({},t,{fetchStatus:p.a.REQ});case A.c5.FAILED:return M({},t,{fetchStatus:p.a.ERR});case A.c5.SUCCESS:var n,r=e.payload.data.items;return M({},t,{item:(n={},n[r[0].itemid]=r[0],n),fetchStatus:p.a.OK});default:return t}},itemIdsByBatch:function(t,e){switch(void 0===t&&(t={}),e.type){case A.Ft.SUCCESS:var n=e.payload,r=n.data,i=r.item_brief_list,a=r.selling_out_item_brief_list,o=n.selectedItemId;return H({},t,function(t){var e,n=t.promotionid,r=t.item_brief_list,i=t.selectedItemId,a=b(t.selling_out_item_brief_list.map((function(t){return t.itemid}))),o=r.map((function(t){return t.itemid})),s=b(O(o,i)),u=r.reduce((function(t,e){var n=e.catid,r=e.itemid;return t[n]=t[n]||[],t[n].push(r),t}),{}),c={};for(var _ in u)c[n+"-"+_]=b(u[_]);return H({},c,((e={})[n+"-"+A.tl]=a,e[n+"-"+A.g$]=s,e))}({promotionid:n.promotionid,item_brief_list:i,selling_out_item_brief_list:a,selectedItemId:o}));case A.gm.REQUESTED:var s,u,c=e.payload,_=c.batchIndex,d=c.promotionid+"-"+c.categoryid;return H({},t,((u={})[d]=H({},t[d],((s={})[_]=H({},t[d][_],{isRequested:!0}),s)),u));case A.gH:return{};default:return t}}},P=(0,S.combineReducers)(U),w=n(5562),j=n(644);function G(t){return t?t.path+"-"+t.cid+"-"+t.id:null}var V,B=n(1372);function Q(){return Q=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Q.apply(this,arguments)}var X=Object.freeze({FLASH_SALE:0,BRAND_SALE:1,SHOP_FLASH_SALE:2}),Y=((V={})[w.Ug]=function(t,e){var n,r=G(e.payload.extraData);if(!r)return t;var i=t[r]||{};return Q({},t,((n={})[r]=Q({},i,{progress:p.a.REQ}),n))},V[w.tk]=function(t,e){var n,r,i=e.payload,a=i.extraData,o=i.data,s=i.timestamp,u=i.promotion_info,c=i.timeslot_info,_=i.recommendation_trace_id,d=G(a);if(!d||!a)return t;var f,E,l=t[d]||{},S=o.sessions||l.sessions||[];if(0===S.length)return Q({},t,((E={pathname:a.path,currentPromotionId:Q({},t.currentPromotionId,(f={},f[d]=void 0,f))})[d]=Q({},l,{sessions:S,progress:p.a.OK}),E));var m=a.soldout_setting;if(a.flash_sale_type===X.SHOP_FLASH_SALE&&S.forEach((function(t){if(1===m){if(t.is_ongoing&&t.items){var e=t.items.filter((function(t){return 0===t.stock})),n=t.items.filter((function(t){return t.stock>0}));t.items=n.concat(e)}}else 2===m&&t.is_ongoing&&t.items&&(t.items=t.items.filter((function(t){return t.stock>0})))})),a.flash_sale_type===j.IG.FLASH_SALE_CATEGORY)if(2===m){if(S[0].is_ongoing){var A=S[0].items.filter((function(t){return t.stock>0}));A.length>=4&&(S[0].items=A)}}else{var I,L;if(S[0].is_ongoing&&0===S[0].items.filter((function(t){return t.stock>0})).length&&S.shift(),0===S.length)return Q({},t,((L={pathname:a.path,currentPromotionId:Q({},t.currentPromotionId,(I={},I[d]=void 0,I))})[d]=Q({},l,{sessions:S,progress:p.a.OK}),L))}a.flash_sale_type===X.SHOP_FLASH_SALE&&S.forEach((function(t){if(t.is_ongoing&&t.items&&t.items.filter((function(t){return 0===t.stock})).length>0){var e=t.promotionid.split("-").map((function(t){return Number(t)}));c.forEach((function(n){var r=new Set(n.promotion_info);e.forEach((function(t){r.has(t)&&r.delete(t)})),0===r.size&&(t.timeslot_info=n)}))}})),S.map((function(t){return t.signature={},(a.flash_sale_type===X.SHOP_FLASH_SALE?t.promotionid.split("-").map((function(t){return Number(t)})):[t.promotionid]).forEach((function(e){var n;t.signature[e]=null===(n=u.filter((function(t){return t.promotionid===e}))[0])||void 0===n?void 0:n.signature})),t}));var T=s||Date.now()/1e3;return S=(S=S.filter((function(t){return t.end_time>T})).filter((function(t){return Array.isArray(t.items)}))).filter((function(t){return!t.is_ongoing||t.items.length>0})),Q({},t,((r={pathname:a.path,currentPromotionId:Q({},t.currentPromotionId,(n={},n[d]=a.currentPromotionId?a.currentPromotionId:S[0].promotionid,n))})[d]=Q({},l,{sessions:S.map((function(e,n){return t[d].sessions?e.promotionid===a.currentPromotionId?e:t[d].sessions[n]:e})),recommendation_trace_id:_,progress:p.a.OK}),r))},V[w.KE]=function(t,e){var n,r=G(e.payload.extraData);if(!r)return t;var i=t[r]||{};return Q({},t,((n={})[r]=Q({},i,{progress:p.a.ERR}),n))},V[w.vm]=function(t,e){var n,r=e.payload,i=r.promotionId,a=G(r.extraData);return a?Q({},t,{currentPromotionId:Q({},t.currentPromotionId,(n={},n[a]=i,n))}):t},V);(0,B.Z)(Y,{});var K=n(2524),x=n(7582);function W(){return W=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},W.apply(this,arguments)}function k(t,e){switch(e.type){case x.rW.REQUESTED:return{itemIds:[],fetchStatus:p.a.REQ};case x.rW.FAILED:return{itemIds:[],fetchStatus:p.a.ERR};case x.rW.SUCCESS:var n=e.payload,r=n.item_brief_list,i=n.from_item,a=r.map((function(t){return t.itemid}));return{itemIds:O(a,i),fetchStatus:p.a.OK};default:return t}}function J(){return J=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},J.apply(this,arguments)}function q(t,e){var n=e.type,r=e.payload||{},i=r.items,a=r.isInitialFetch;switch(n){case x.Js.REQUESTED:return a?{items:{},numberOfFetchedItems:0,initialFetchStatus:p.a.REQ,fetchStatus:p.a.REQ}:J({},t,{fetchStatus:p.a.REQ});case x.Js.FAILED:return J({},t,a?{initialFetchStatus:p.a.ERR}:{fetchStatus:p.a.ERR});case x.Js.SUCCESS:var o=t.items,s=t.numberOfFetchedItems,u=t.initialFetchStatus,c=i.reduce((function(t,e){return t[e.itemid]=e,t}),{});return{items:J({},o,c),numberOfFetchedItems:s+i.length,initialFetchStatus:a?p.a.OK:u,fetchStatus:p.a.OK}}}function z(){return z=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},z.apply(this,arguments)}function Z(){return Z=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Z.apply(this,arguments)}function $(){return $=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$.apply(this,arguments)}var tt=(0,S.combineReducers)({fetchAllSessionsStatus:function(t,e){switch(void 0===t&&(t=p.a.INIT),e.type){case x.N9.REQUESTED:return p.a.REQ;case x.N9.FAILED:return p.a.ERR;case x.N9.SUCCESS:return p.a.OK;case A.gH:return p.a.INIT;default:return t}},allSessions:function(t,e){void 0===t&&(t={promotionIds:[],sessions:{}});var n=e.type,r=(e.payload||{}).sessions;switch(n){case x.N9.REQUESTED:case x.N9.FAILED:return t;case x.N9.SUCCESS:return{promotionIds:r.map((function(t){return t.promotionid})),sessions:r.reduce((function(t,e){return t[e.promotionid]=e,t}),{})};case A.gH:return{promotionIds:[],sessions:{}};default:return t}},itemIds:function(t,e){var n,r,i;void 0===t&&(t={});var a=e.type,o=(e.payload||{}).promotionid;switch(a){case x.rW.REQUESTED:return W({},t,((n={})[o]=k(t[o],e),n));case x.rW.FAILED:return W({},t,((r={})[o]=k(t[o],e),r));case x.rW.SUCCESS:return W({},t,((i={})[o]=k(t[o],e),i));case x.jP:var s,u=e.payload,c=u.boundariesOfItemIdsToFetch,_=u.fetchedItemIds,d=u.promotionid,f=t[d].itemIds,E=c.split("-").map((function(t){return parseInt(t,10)})),l=f.indexOf(E[0]),S=f.indexOf(E[1]),m=f.slice(0,l),p=f.slice(S+1),I=m.concat(_).concat(p);return W({},t,((s={})[d]=W({},t[d],{itemIds:I}),s));case x.q2:var L,T=e.payload.selectedPromotionId;return W({},t,((L={})[T]=function(t,e){if(e.type===x.q2){if(!t)return t;var n=e.payload.selectedItemId;return W({},t,{itemIds:O(t.itemIds,n)})}return t}(t[T],e),L));case A.gH:return{};default:return t}},items:function(t,e){var n,r,i;void 0===t&&(t={});var a=e.type,o=(e.payload||{}).promotionid;switch(a){case x.Js.REQUESTED:return J({},t,((n={})[o]=q(t[o],e),n));case x.Js.FAILED:return J({},t,((r={})[o]=q(t[o],e),r));case x.Js.SUCCESS:return J({},t,((i={})[o]=q(t[o],e),i));case A.gH:return{};default:return t}},selectedPromotionId:function(t,e){switch(void 0===t&&(t=null),e.type){case x.S4:return e.payload.selectedPromotionId;case A.gH:return null;default:return t}},recommendationInfo:function(t,e){switch(void 0===t&&(t={}),e.type){case x.rW.REQUESTED:case x.rW.FAILED:return t;case x.rW.SUCCESS:return z({},t,e.payload.item_brief_list.reduce((function(t,e){var n=e.itemid,r=e.recommendation_info;return t[n]={recommendationInfo:r},t}),{}));case A.gH:return{};default:return t}},queryObjects:function(t,e){switch(void 0===t&&(t={}),e.type){case x.S4:var n,r=e.payload,i=r.selectedPromotionId,a=r.selectedItemId,o=r.isLandingPage;return i in t||!o?t:Z({},t,((n={})[i]=a?{fromItem:a,promotionId:i}:{promotionId:i},n));case A.gH:return{};default:return t}},itemIdsByBatch:function(t,e){switch(void 0===t&&(t={}),e.type){case x.rW.SUCCESS:var n,r=e.payload,i=r.item_brief_list,a=r.from_item,o=r.promotionid,s=i.map((function(t){return t.itemid})),u=O(s,a);return $({},t,((n={})[o]=function(t){for(var e={},n=0;n<t.length;n+=x.iO){var r=n+x.iO<=t.length?n+x.iO:t.length,i=t.slice(n,r);e[Math.floor(n/x.iO)]={itemIdsToFetch:i,boundaries:i[0]+"-"+i[i.length-1],isRequested:!1}}return e}(u),n));case x.Js.REQUESTED:var c,_,d=e.payload,f=d.batchIndex,E=d.promotionid;return $({},t,((_={})[E]=$({},t[E],((c={})[f]=$({},t[E][f],{isRequested:!0}),c)),_));case A.gH:return{};default:return t}}}),et=n(3931),nt=n(7758),rt=(0,l.K)({reducers:{flashSale:P,sMartFlashSale:tt,micrositeFlashSaleSoldOut:function(t,e){switch(void 0===t&&(t={item:{},fetchStatus:p.a.INIT}),e.type){case j.bG.REQUESTED:return Q({},t,{fetchStatus:p.a.REQ});case j.bG.FAILED:return Q({},t,{fetchStatus:p.a.ERR});case j.bG.SUCCESS:var n,r=e.payload.sessions[0].items[0];return{item:(n={},n[r.itemid]=r,n),fetchStatus:p.a.OK};default:return t}},fsSoldoutRcmd:K.O,rcmdShop:et.I6,sharedSearch:nt.X},enhancer:E.Uo.apply(void 0,[(0,S.applyMiddleware)(m.Z)])});function it(){return it=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},it.apply(this,arguments)}var at=179,ot=a.I18n.withI18nCollections,st=function(t){var e=i().forwardRef((function(e,n){return i().createElement(s.Provider,{store:rt.store},i().createElement(f.InjectReducerContext.Provider,{value:{injectAsyncReducer:rt.injectReducer}},i().createElement(i().Suspense,{fallback:i().createElement("div",null,i().createElement(d.Z,{show:!0,hideOverlay:!0}))},i().createElement(_.SV,{errorComponent:function(){return i().createElement("div",null,"App failed")}},i().createElement(o.Z,{onTrack:a.Tracking.onTrack},i().createElement(t,it({},e,{ref:n})))))))})),n=function(t){return t.displayName||t.name||"Component"}(e);return e.displayName="WithFlashSaleWrap("+n+")",ot([u.x7,u.L,c.yd.pc,at].concat(u.mD),(function(){return i().createElement("div",null)}))(e)}},7114:function(t,e,n){"use strict";t.exports=n.microfeI(2)},843:function(t,e,n){"use strict";t.exports=n.microfeI(3)},7705:function(t,e,n){"use strict";t.exports=n.microfeI(1)},3255:function(t,e,n){"use strict";t.exports=n.microfeI(4)},7944:function(t,e,n){"use strict";t.exports=n.microfeI(0)}}]);
//# sourceMappingURL=https://sourcemap.webfe.shopee.io/pcmall-flashsale/_/249.d3700326216cd18ed0fc.legacy.js.map